{% extends "core.html" %}

{% block head %}
{% load static %}
<link rel="stylesheet" href="{% static 'simulation.css' %}">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{%endblock%}

{% block content %}
<div>
  <h2>Configurations</h2>
  <div class = 'sim_conf'>
    <p>Qubits</p>
    <div>
      <input>
      <input>
    </div>
  </div>
  <div class = 'sim_conf'>
    <p>Depth</p>
    <div>
      <input type='number'>
    </div>
  </div>
  <div class = 'sim_conf'>
    <p>Evaluations</p>
    <div>
      <input>
    </div>
  </div>
  <h2>Environments</h2>
  <form id="env_filter" method="get">
    <button class='env_visibility_toggle' type='checkbox'>All</button>
    <input type="hidden" name="simulator_filter" value="{{ request.GET.simulator_filter }}">
    <input type="hidden" name="hardware_filter" value="{{ request.GET.hardware_filter }}">
    <div class="dropdown">
      <div class="dropbtn">{{ request.GET.hardware_filter|default:"Hardware"}}</div>
      <div class="dropdown-content">
        {% if request.GET.hardware_filter %}
          <button name="hardware_filter" type="submit" value="">All</button>
        {% endif %}
        {% for hardware in hardware_profiles %}
          {% if request.GET.hardware_filter != hardware.name%}
            <button name="hardware_filter" type="submit" value="{{hardware.name}}">{{hardware.name}}</button>
          {% endif %}
        {% endfor %}
      </div>
    </div>
    <div class="dropdown">
      <div class="dropbtn">{{ request.GET.simulator_filter|default:"Simulator"}}</div>
      <div class="dropdown-content">
        {% if request.GET.simulator_filter %}
          <button name="simulator_filter" type="submit" value="">All</button>
        {% endif %}
        {% for simulator in simulator_profiles %}
          {% if request.GET.simulator_filter != simulator.name%}
            <button name="simulator_filter" type="submit" value="{{simulator.name}}">{{simulator.name}}</button>
          {% endif %}
        {% endfor %}
      </div>
    </div>
  </form>
  <div id="sim_envs">
    {% for env in environments %}
    <div class='env_container'>
      <button class='env_visibility_toggle' type='checkbox'></button>
      <p>{{ env.simulator.name }}</p>
      <p>{{ env.hardware.name }}</p>
    </div>
    {% endfor %}
  </div>
</div>
<div id="graph_container">
  <canvas id="graph_canvast"></canvas>
</div>
{{ graph_data|json_script:"grap_data_container" }}
<script>
  const graph_data = JSON.parse(
    document.getElementById('grap_data_container').textContent
  );

  console.log(graph_data.max)
  const config = {
    type: 'line',
    data: {
      labels: graph_data.labels,
      datasets: graph_data.data
    },
    options: {
      responsive: true,
      scales: {
        y: {
          ticks: {
            max: graph_data.max
        }
        }
      }
    },
  };

  new Chart(
    document.getElementById("graph_canvast"),
    config
  )
</script>
{% endblock %}
